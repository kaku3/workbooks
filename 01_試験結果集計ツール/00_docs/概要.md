@import "./style.less"

# 試験進捗集計ツール

試験項目書を解析して、試験結果・進捗の集計を行うツール。
最初から高機能に作ろうとするとモチベーションが維持できないため、段階的リリースとする。

## 要素技術

- Node.js : 集計
- Nuxt.js : グラフ表示

本リポジトリで提供するのは、Node.js, Nuxt.js だが、python や Next.js 等他の言語で作っても良いと思う。


## 機能(集計) : 1

1. コマンドラインより実行するツール
1. コマンドラインで指定されたExcelファイルを読み込む
1. Excelファイルの[単体試験]シートの内容を解析する
    1. 試験件数
    1. OK/NG/保留/確認OK/修正OK
1. 結果を json ファイルとして出力する

@import "./images/00_aggregation-1.drawio.png"


### シーケンス

@import "./puml/00_aggregation-1.puml"


### Excel フォーマット

|項目   |内容   |
|---|---|
|試験番号|試験項目に対する一意の番号。 
|カテゴリ|試験区分。初期表示、バリデーションなど。大項目、中項目…と細かいフォーマットにすることもある。<br/>解釈や記載に個人差が出ることが多いので個人的には細かく定義しない方がよいと感じている。
|試験項目|試験の観点が分かる簡潔な項目名をつける。
|手順|試験手順。障害表にそのまま転記できるよう、読んだだけで実行可能な一意の手順を書く。
|期待値|「手順」通り実行した場合にどのような結果になる仕様か分かる期待値を書く。
|結果|試験結果を書く。プロジェクトにより結果の種類は変わる。
||OK : 期待値通りの結果
||NG : 期待値通りの結果とならなかった
||確認OK : NG -> 確認 -> 仕様通り、処置なしでOK
||修正OK : NG -> 修正 -> 修正確認OK
||保留 : NGだが、協議の結果、本フェーズでは対応しないとしたもの。
|実施者|試験を実施した担当者の名前を記載。
|実施日|試験を実施した日を記載。
|備考|確認OKや保留などの結果記載時にはその理由を記載。

### 解答例

[01_解答例_集計_1](../10_src/01_%E8%A7%A3%E7%AD%94%E4%BE%8B_%E9%9B%86%E8%A8%88_1/aggregation.js)

## 機能(集計) : 2

1. 指定されたフォルダ内の Excel ファイル全てを読み込み同様に集計

@import "./images/00_aggregation-2.drawio.png"

### シーケンス

@import "./puml/00_aggregation-2.puml"

### 解答例

[01_解答例_集計_2](../10_src/01_%E8%A7%A3%E7%AD%94%E4%BE%8B_%E9%9B%86%E8%A8%88_2/aggregation.js)

## 機能(集計) : 3

1. 試験実施日、試験実施者毎で集計できるようにする


## 機能(UI) : 1

1. json で出力した結果を表形式で表示する

localで動作する htmlファイルとして出力すること。

### 課題

1. index.html ファイルを作成する
1. jQuery, jQuery DataTables を読み込む
1. 機能(集計) : 2 で作成した test.json を読み込む
1. test.json を DataTables で表示する


### ワンポイント解説

#### javascript library について
javascript には便利なライブラリファイルが大量に存在する。
それらはネットワーク上に存在していて `<script>` タグで読み込んで利用することができる。

```html
<script type="text/javascript" src="{利用したいライブラリのパス}"></script>
```

今回は jQuery と jQueryDataTables を利用する。それぞれ以下の様にググって、jsとcss のタグを取得し、ソースに貼る。

```
cdn jquery
cdn datatables
```

- jQuery
  https://api.jquery.com/
  html 中の任意の要素を簡単に操作するための javascript ライブラリ。
  2022年現在では利用しない方がトレンドになりつつあるが過去の遺産を扱うSES系IT業界ではまだまだ現役。

  jQuery のディストリビューションには以下が存在する。

  |拡張子(x.js)   |内容   |
  |---|---|
  |無印   |非圧縮版。デバッグ用。容量が大きいため、ページの表示が遅くなる。   |
  |min   |圧縮版。人間には読めないが、容量が小さく、ページの表示が速くなる。   |
  |slim   |通信系 api などが削除されたもの。容量が小さい。   |
  |slim.min   |最高に容量が小さい。   |

- jquery data tables
  https://cdn.datatables.net/1.12.0/
  データをテーブル表示するライブラリ。インクリメンタルフィルタもあり優秀。
  Bootstrap 対応版もある。

  デザインも含むため、js と css を読み込む必要がある。
  また、autofill などリッチな機能は plugin として提供されており、利用する機能に応じて読み込むファイルが増える。

#### タグを貼る場所について
ページが少しでも速く読み込まれ、読み込み中に表示が崩れないようにするため、css は head タグの最後、js は body タグの最後で読み込む風習がある。
また、script タグは『書いた順番』で読み込まれるため、jQuery より先に jQuery DataTables を書くと、うまく動作しないかもしれない。(jQuery DataTables で jQuery を利用しているが、読み込んでないため利用できない)
vue や react のプロジェクトでは、webpack がよろしくやってくれるのであまり意識することはない。

そして、こうして書いているコメントもページの読み込み速度の低下につながる。

#### data について
json データもスクリプトタグで読み込み可能。ただし、テキストとして読み込まれるので json として扱える様にパースする必要がある。

#### セミコロンについて
javascript は、行の末尾にセミコロンを書いても書かなくても動作する。
ところが「セミコロンを書いてない場合」予期しない動作が起きることがある。
セミコロンは必ず書くこと。

```js
// 以下は動作しない
//※const a = 1[ 'aaa', 'bbb' ].forEach(t => console.log(t)) と解釈される
const a = 1
[ 'aaa', 'bbb' ].forEach(t => console.log(t))

// 以下は動作する
const a = 1;
[ 'aaa', 'bbb' ].forEach(t => console.log(t));
```

#### Live Server / Live Sass Compiler について
VS Code のエクステンション。
エディタで保存すると自動でリロードしてくれる便利サーバと、sass コンパイラ。
ローカルで動作する html 開発の課題ではあるが、開発は便利に行った方がよい。

- [Live Server](https://marketplace.visualstudio.com/items?itemName=ritwickdey.LiveServer)
- [Live Sass Compiler](https://marketplace.visualstudio.com/items?itemName=glenn2223.live-sass)


## 機能(UI) : 2

1. json で出力した結果をグラフ形式で表示する

