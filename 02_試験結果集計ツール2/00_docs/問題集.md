@import "./style.less"

# 試験結果集計ツール2


<!-- @import "[TOC]" {cmd="toc" depthFrom=1 depthTo=6 orderedList=false} -->

<!-- code_chunk_output -->

- [試験結果集計ツール2](#試験結果集計ツール2)
  - [はじめに](#はじめに)
  - [要素技術](#要素技術)
  - [機能追加(集計) : 1](#機能追加集計-1)
    - [設計コラム : 『集計時に』ついて](#設計コラム-集計時について)

<!-- /code_chunk_output -->


## はじめに

デイリーの集計が不要な小規模プロジェクトを考慮して、課題を分けました。

本課題の前に[試験結果集計ツール](../../01_%E8%A9%A6%E9%A8%93%E7%B5%90%E6%9E%9C%E9%9B%86%E8%A8%88%E3%83%84%E3%83%BC%E3%83%AB/00_docs/%E5%95%8F%E9%A1%8C%E9%9B%86.md)を実施しておいてください。

また、レポートを欲しがる上層部に http server を用意してくださいとは言えないので、実践的な html 版の課題が続きます。Nuxt.js 編の課題はもう少し後になります。


## 要素技術

- Node.js : 集計
- html, jQuery, DataTables : 表示
- chart.js : グラフ表示


## 機能追加(集計) : 1

Excel日付を表示用日付に変換する。
集計ツールで出力されたデータの試験実施日を確認すると以下のような値であることが確認できる。

```
"testDate":44844
```

これは、シリアル値と呼ばれるマイクロソフト独自の日時表現形式だ。

1900年1月1日を1として、以後24時間経過するごとに1を加えている。
※1日未満は小数点で表現。

この値を表示しても試験実施日は分からないので、**集計時に**yyyy/mm/dd形式の値も保存する様に修正する。

```
"displayTestDate":"2022/10/10"
```


### 設計コラム : 『集計時に』ついて

シリアル値→日付変換は、計算で求まる値であるため集計時に保持する必要はない。
クライアント側で表示する時に計算で求めればデータを保持する量が少なくなるためDBやストレージには優しい。

ところが今回は、クライアント側を2種類(jQuery版、nuxt版)作成する計画がある。とした場合、それぞれのクライアントに対して日付変換処理を実装するよりは集計処理側に実装する方がコスパがよいと考えられる。

また、冒頭で述べた様に、このツールで出力される**レポートを閲覧するユーザーがサーバを用意できないといった条件がある場合**実装者はNuxt.jsやNext.jsで製造する方が簡単でも、それらのフレームワークを選択することはできなくなる。[^1]

このように、**最適な実装方法はシステムを取り巻く条件や環境**によって変わってくるということを覚えておくと、より摩擦の少ない良い設計ができるようになると思う。


[^1]: どんなにプログラム的に最適で美しくても、ユーザーが使えないのであればそれはただのプログラムでありプロダクトではない。お金を生むのはプログラムではなくプロダクト。
